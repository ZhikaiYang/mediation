---
title: "Calculate genetic variances"
author: "Zhikai Yang"
date: "April 1st, 2020"
output: NULL
---


## Normalize the path:

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE) 
knitr::opts_knit$set(root.dir=normalizePath('../../')) 
```

### read in data
```{r}
gddtosilk <- read.csv("data/med_proportion_gddtosilk_0.032_pruned_r.csv", header=TRUE)
gddtosilk$snps <- rep("p1m", nrow(gddtosilk))
gddtosilk$trait <- rep("gddtosilk", nrow(gddtosilk))
gddtosilk$tissue  <- factor(gddtosilk$tissue, levels=c("gs", "groot", "l3t", "l3b", "ld268", "ln268", "kern"))

gddtosilk_p7msnps <- read.csv("data/med_proportion_gddtosilk_p7msnps_r.csv", header=TRUE)
gddtosilk_p7msnps$snps <- rep("p7m", nrow(gddtosilk_p7msnps))
gddtosilk_p7msnps$trait <- rep("gddtosilk", nrow(gddtosilk_p7msnps))
gddtosilk_p7msnps$tissue  <- factor(gddtosilk_p7msnps$tissue, levels=c("gs", "groot", "l3t", "l3b", "ld268", "ln268", "kern"))

daystosilk <- read.csv("data/med_proportion_daystosilk_0.032_pruned_r.csv", header=TRUE)
daystosilk$snps <- rep("p1m", nrow(daystosilk))
daystosilk$trait <- rep("daystosilk", nrow(daystosilk))
daystosilk$tissue  <- factor(daystosilk$tissue, levels=c("gs", "groot", "l3t", "l3b", "ld268", "ln268", "kern"))

daystosilk_p7msnps <- read.csv("data/med_proportion_daystosilk_p7msnps_r.csv", header=TRUE)
daystosilk_p7msnps$snps <- rep("p7m", nrow(daystosilk_p7msnps))
daystosilk_p7msnps$trait <- rep("daystosilk", nrow(daystosilk_p7msnps))
daystosilk_p7msnps$tissue  <- factor(daystosilk_p7msnps$tissue, levels=c("gs", "groot", "l3t", "l3b", "ld268", "ln268", "kern"))

gddtotassel <- read.csv("data/med_proportion_gddtotassel_0.032_pruned_r.csv", header=TRUE)
gddtotassel$snps <- rep("p1m", nrow(gddtotassel))
gddtotassel$trait <- rep("gddtotassel", nrow(gddtotassel))
gddtotassel$tissue  <- factor(gddtotassel$tissue, levels=c("gs", "groot", "l3t", "l3b", "ld268", "ln268", "kern"))

gddtotassel_p7msnps <- read.csv("data/med_proportion_gddtotassel_p7msnps_r.csv", header=TRUE)
gddtotassel_p7msnps$snps <- rep("p7m", nrow(gddtotassel_p7msnps))
gddtotassel_p7msnps$trait <- rep("gddtotassel", nrow(gddtotassel_p7msnps))
gddtotassel_p7msnps$tissue  <- factor(gddtotassel_p7msnps$tissue, levels=c("gs", "groot", "l3t", "l3b", "ld268", "ln268", "kern"))

daystotassel <- read.csv("data/med_proportion_daystotassel_0.032_pruned_r.csv", header=TRUE)
daystotassel$snps <- rep("p1m", nrow(daystotassel))
daystotassel$trait <- rep("daystotassel", nrow(daystotassel))
daystotassel$tissue  <- factor(daystotassel$tissue, levels=c("gs", "groot", "l3t", "l3b", "ld268", "ln268", "kern"))

daystotassel_p7msnps <- read.csv("data/med_proportion_daystotassel_p7msnps_r.csv", header=TRUE)
daystotassel_p7msnps$snps <- rep("p7m", nrow(daystotassel_p7msnps))
daystotassel_p7msnps$trait <- rep("daystotassel", nrow(daystotassel_p7msnps))
daystotassel_p7msnps$tissue  <- factor(daystotassel_p7msnps$tissue, levels=c("gs", "groot", "l3t", "l3b", "ld268", "ln268", "kern"))

cobd <- read.csv("data/med_proportion_cobd_0.032_pruned_r.csv", header=TRUE)
cobd$snps <- rep("p1m", nrow(cobd))
cobd$trait <- rep("cobd", nrow(cobd))
cobd$tissue  <- factor(cobd$tissue, levels=c("gs", "groot", "l3t", "l3b", "ld268", "ln268", "kern"))

cobd_p7msnps <- read.csv("data/med_proportion_cobd_p7msnps_r.csv", header=TRUE)
cobd_p7msnps$snps <- rep("p7m", nrow(cobd_p7msnps))
cobd_p7msnps$trait <- rep("cobd", nrow(cobd_p7msnps))
cobd_p7msnps$tissue  <- factor(cobd_p7msnps$tissue, levels=c("gs", "groot", "l3t", "l3b", "ld268", "ln268", "kern"))

tkv <- read.csv("data/med_proportion_tkv_0.032_pruned_r.csv", header=TRUE)
tkv$snps <- rep("p1m", nrow(tkv))
tkv$trait <- rep("tkv", nrow(tkv))
tkv$tissue  <- factor(tkv$tissue, levels=c("gs", "groot", "l3t", "l3b", "ld268", "ln268", "kern"))

tkv_p7msnps <- read.csv("data/med_proportion_tkv_p7msnps_r.csv", header=TRUE)
tkv_p7msnps$snps <- rep("p7m", nrow(tkv_p7msnps))
tkv_p7msnps$trait <- rep("tkv", nrow(tkv_p7msnps))
tkv_p7msnps$tissue  <- factor(tkv_p7msnps$tissue, levels=c("gs", "groot", "l3t", "l3b", "ld268", "ln268", "kern"))

df <- rbind(gddtosilk, gddtosilk_p7msnps, daystosilk, daystosilk_p7msnps, gddtotassel, gddtotassel_p7msnps, daystotassel,daystotassel_p7msnps, cobd, cobd_p7msnps, tkv, tkv_p7msnps)

library(dplyr)

df_p1m <- filter(df, snps %in% c("p1m"))
df_p7m <- filter(df, snps %in% c("p7m"))


```


### Visualization p1m
```{r}
library(ggplot2)
library(ggpubr)


p11 <- ggplot(data=gddtosilk, aes(x=tissue, y=pmed.pure, fill=method)) +
geom_bar(stat="identity", position=position_dodge())+ ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("gddtosilk")+
  theme_minimal()

p12 <- ggplot(data=daystosilk, aes(x=tissue, y=pmed.pure, fill=method)) +
geom_bar(stat="identity", position=position_dodge())+ ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("daystosilk")+
  theme_minimal()


p13 <- ggplot(data=gddtotassel, aes(x=tissue, y=pmed.pure, fill=method)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("gddtotassel")+
  theme_minimal()

p14 <- ggplot(data=daystotassel, aes(x=tissue, y=pmed.pure, fill=method)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("daystotassel")+
  theme_minimal()

p15 <- ggplot(data=cobd, aes(x=tissue, y=pmed.pure, fill=method)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("cobd")+
  theme_minimal()

p16 <- ggplot(data=tkv, aes(x=tissue, y=pmed.pure, fill=method)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("tkv")+
  theme_minimal()


ggarrange(p11, p13, p15, p12, p14, p16 , 
          ncol = 3, nrow = 2)

```


### Visualization p7m
```{r}

p21 <- ggplot(data=gddtosilk_p7msnps, aes(x=tissue, y=pmed.pure, fill=method)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, 1)+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("gddtosilk_p7msnps")+
  theme_minimal()

p22 <- ggplot(data=daystosilk_p7msnps, aes(x=tissue, y=pmed.pure, fill=method)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, 1)+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("daystosilk_p7msnps")+
  theme_minimal()


p23 <- ggplot(data=gddtotassel_p7msnps, aes(x=tissue, y=pmed.pure, fill=method)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, 1)+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("gddtotassel_p7msnps")+
  theme_minimal()

p24 <- ggplot(data=daystotassel_p7msnps, aes(x=tissue, y=pmed.pure, fill=method)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, 1)+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("daystotassel_p7msnps")+
  theme_minimal()

p25 <- ggplot(data=cobd_p7msnps, aes(x=tissue, y=pmed.pure, fill=method)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, 1)+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("cobd_p7msnps")+
  theme_minimal()

p26 <- ggplot(data=tkv_p7msnps, aes(x=tissue, y=pmed.pure, fill=method)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, 1)+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("tkv_p7msnps")+
  theme_minimal()

ggarrange(p21, p23, p25, p22, p24, p26 , 
          ncol = 3, nrow = 2)




```

###comparision between p1m and p7m (medfix0.5)
```{r}
gddtosilk <- filter(df, trait %in% c("gddtosilk"), method %in% c("medfix0.5"))
daystosilk <- filter(df, trait %in% c("daystosilk"), method %in% c("medfix0.5"))
gddtotassel <- filter(df, trait %in% c("gddtotassel"), method %in% c("medfix0.5"))
daystotassel <- filter(df, trait %in% c("daystotassel"), method %in% c("medfix0.5"))
cobd <- filter(df, trait %in% c("cobd"), method %in% c("medfix0.5"))
tkv <- filter(df, trait %in% c("tkv"), method %in% c("medfix0.5"))


p31 <- ggplot(data=gddtosilk, aes(x=tissue, y=pmed.pure, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("gddtosilk")+
  theme_minimal()

p32 <- ggplot(data=daystosilk, aes(x=tissue, y=pmed.pure, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("daystosilk")+
  theme_minimal()


p33 <- ggplot(data=gddtotassel, aes(x=tissue, y=pmed.pure, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("gddtotassel")+
  theme_minimal()

p34 <- ggplot(data=daystotassel, aes(x=tissue, y=pmed.pure, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("daystotassel")+
  theme_minimal()

p35 <- ggplot(data=cobd, aes(x=tissue, y=pmed.pure, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("cobd")+
  theme_minimal()

p36 <- ggplot(data=tkv, aes(x=tissue, y=pmed.pure, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("tkv")+
  theme_minimal()


ggarrange(p31, p33, p35, p32, p34, p36 , 
          ncol = 3, nrow = 2)



```



###comparision between p1m and p7m (medfixbic)
```{r}
gddtosilk <- filter(df, trait %in% c("gddtosilk"), method %in% c("medfixbic"))
daystosilk <- filter(df, trait %in% c("daystosilk"), method %in% c("medfixbic"))
gddtotassel <- filter(df, trait %in% c("gddtotassel"), method %in% c("medfixbic"))
daystotassel <- filter(df, trait %in% c("daystotassel"), method %in% c("medfixbic"))
cobd <- filter(df, trait %in% c("cobd"), method %in% c("medfixbic"))
tkv <- filter(df, trait %in% c("tkv"), method %in% c("medfixbic"))

p41 <- ggplot(data=gddtosilk, aes(x=tissue, y=pmed.pure, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("gddtosilk")+
  theme_minimal()

p42 <- ggplot(data=daystosilk, aes(x=tissue, y=pmed.pure, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("daystosilk")+
  theme_minimal()


p43 <- ggplot(data=gddtotassel, aes(x=tissue, y=pmed.pure, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("gddtotassel")+
  theme_minimal()

p44 <- ggplot(data=daystotassel, aes(x=tissue, y=pmed.pure, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("daystotassel")+
  theme_minimal()

p45 <- ggplot(data=cobd, aes(x=tissue, y=pmed.pure, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("cobd")+
  theme_minimal()

p46 <- ggplot(data=tkv, aes(x=tissue, y=pmed.pure, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$pmed.pure))+
  #geom_text(aes(label=pmed.pure), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("tkv")+
  theme_minimal()


ggarrange(p41, p43, p45, p42, p44, p46 , 
          ncol = 3, nrow = 2)



```


###comparision between p1m and p7m (medfix0.5)(n.med)
```{r}
gddtosilk <- filter(df, trait %in% c("gddtosilk"), method %in% c("medfix0.5"))
daystosilk <- filter(df, trait %in% c("daystosilk"), method %in% c("medfix0.5"))
gddtotassel <- filter(df, trait %in% c("gddtotassel"), method %in% c("medfix0.5"))
daystotassel <- filter(df, trait %in% c("daystotassel"), method %in% c("medfix0.5"))
cobd <- filter(df, trait %in% c("cobd"), method %in% c("medfix0.5"))
tkv <- filter(df, trait %in% c("tkv"), method %in% c("medfix0.5"))


p51 <- ggplot(data=gddtosilk, aes(x=tissue, y=n.med, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ ylim(0, max(df$n.med))+
  #geom_text(aes(label=n.med), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("gddtosilk")+
  theme_minimal()

p52 <- ggplot(data=daystosilk, aes(x=tissue, y=n.med, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ ylim(0, max(df$n.med))+
  #geom_text(aes(label=n.med), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("daystosilk")+
  theme_minimal()


p53 <- ggplot(data=gddtotassel, aes(x=tissue, y=n.med, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$n.med))+
  #geom_text(aes(label=n.med), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("gddtotassel")+
  theme_minimal()

p54 <- ggplot(data=daystotassel, aes(x=tissue, y=n.med, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$n.med))+
  #geom_text(aes(label=n.med), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("daystotassel")+
  theme_minimal()

p55 <- ggplot(data=cobd, aes(x=tissue, y=n.med, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$n.med))+
  #geom_text(aes(label=n.med), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("cobd")+
  theme_minimal()

p56 <- ggplot(data=tkv, aes(x=tissue, y=n.med, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$n.med))+
  #geom_text(aes(label=n.med), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("tkv")+
  theme_minimal()


ggarrange(p51, p53, p55, p52, p54, p56 , 
          ncol = 3, nrow = 2)



```



###comparision between p1m and p7m (medfixbic)(n.med)
```{r}
gddtosilk <- filter(df, trait %in% c("gddtosilk"), method %in% c("medfixbic"))
daystosilk <- filter(df, trait %in% c("daystosilk"), method %in% c("medfixbic"))
gddtotassel <- filter(df, trait %in% c("gddtotassel"), method %in% c("medfixbic"))
daystotassel <- filter(df, trait %in% c("daystotassel"), method %in% c("medfixbic"))
cobd <- filter(df, trait %in% c("cobd"), method %in% c("medfixbic"))
tkv <- filter(df, trait %in% c("tkv"), method %in% c("medfixbic"))

p61 <- ggplot(data=gddtosilk, aes(x=tissue, y=n.med, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ ylim(0, max(df$n.med))+
  #geom_text(aes(label=n.med), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("gddtosilk")+
  theme_minimal()

p62 <- ggplot(data=daystosilk, aes(x=tissue, y=n.med, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ ylim(0, max(df$n.med))+
  #geom_text(aes(label=n.med), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("daystosilk")+
  theme_minimal()


p63 <- ggplot(data=gddtotassel, aes(x=tissue, y=n.med, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$n.med))+
  #geom_text(aes(label=n.med), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("gddtotassel")+
  theme_minimal()

p64 <- ggplot(data=daystotassel, aes(x=tissue, y=n.med, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$n.med))+
  #geom_text(aes(label=n.med), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("daystotassel")+
  theme_minimal()

p65 <- ggplot(data=cobd, aes(x=tissue, y=n.med, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$n.med))+
  #geom_text(aes(label=n.med), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("cobd")+
  theme_minimal()

p66 <- ggplot(data=tkv, aes(x=tissue, y=n.med, fill=snps)) +
geom_bar(stat="identity", position=position_dodge())+ylim(0, max(df$n.med))+
  #geom_text(aes(label=n.med), vjust=1.6, color="white",
  #         position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")+ ggtitle("tkv")+
  theme_minimal()


ggarrange(p61, p63, p65, p62, p64, p66 , 
          ncol = 3, nrow = 2)



```



### Correlation between med.pure and Heritablity
```{r}
df_h <- filter(df, trait %in% c("daystosilk", "daystotassel", "cobd", "tkv"))

df_h$hp <- c(rep(0.70, 56),rep(0.71, 56), rep(0.42, 56), rep(0.23, 56)) 

df_h$hl <- c(rep(0.94, 56),rep(0.94, 56), rep(0.78, 56), rep(0.59, 56)) 

df_h$hlw <- c(rep(0.85, 56),rep(0.78, 56), rep(0.73, 56), rep(0.52, 56)) 

df_h$hc <- c(rep(0.96, 56),rep(0.97, 56), rep(0.79, 56), rep(0.62, 56)) 

df_h$method_snps <- rep("fill", nrow(df_h))

df_h$method_snps = paste(as.character(df_h$method) , as.character(df_h$snps), sep= "_")

df_h <- filter(df_h, method %in% c("medfix0.5","medfixbic"))

df_h_gs <- filter(df_h, tissue %in% c("gs"))
p71 <- ggplot(df_h_gs, aes(x=hp, y=pmed.pure, color=method_snps, shape=method_snps)) +
  geom_point()+ ggtitle("gs") + 
  geom_smooth(method=lm ,se=FALSE, fullrange=TRUE)

df_h_groot <- filter(df_h, tissue %in% c("groot"))
p72 <- ggplot(df_h_groot, aes(x=hp, y=pmed.pure, color=method_snps, shape=method_snps)) +
  geom_point()+ ggtitle("groot") + 
  geom_smooth(method=lm ,se=FALSE, fullrange=TRUE)

df_h_l3t <- filter(df_h, tissue %in% c("l3t"))
p73 <- ggplot(df_h_l3t, aes(x=hp, y=pmed.pure, color=method_snps, shape=method_snps)) +
  geom_point()+ ggtitle("l3t") + 
  geom_smooth(method=lm ,se=FALSE, fullrange=TRUE)

df_h_l3b <- filter(df_h, tissue %in% c("l3b"))
p74 <- ggplot(df_h_l3b, aes(x=hp, y=pmed.pure, color=method_snps, shape=method_snps)) +
  geom_point()+ ggtitle("l3b") + 
  geom_smooth(method=lm ,se=FALSE, fullrange=TRUE)

df_h_ld268 <- filter(df_h, tissue %in% c("ld268"))
p75 <- ggplot(df_h_ld268, aes(x=hp, y=pmed.pure, color=method_snps, shape=method_snps)) +
  geom_point()+ ggtitle("ld268") + 
  geom_smooth(method=lm ,se=FALSE, fullrange=TRUE)

df_h_ln268 <- filter(df_h, tissue %in% c("ln268"))
p76 <- ggplot(df_h_ln268, aes(x=hp, y=pmed.pure, color=method_snps, shape=method_snps)) +
  geom_point()+ ggtitle("ln268") + 
  geom_smooth(method=lm ,se=FALSE, fullrange=TRUE)

df_h_kern <- filter(df_h, tissue %in% c("kern"))
p77 <- ggplot(df_h_kern, aes(x=hp, y=pmed.pure, color=method_snps, shape=method_snps)) +
  geom_point()+ ggtitle("kern") + 
  geom_smooth(method=lm ,se=FALSE, fullrange=TRUE)

df_h_medfix0.5_p1m <- filter(df_h, method_snps %in% c("medfix0.5_p1m"))
p78 <- ggplot(df_h_medfix0.5_p1m, aes(x=hp, y=pmed.pure, color=tissue, shape=tissue)) +
  geom_point()+ ggtitle("medfix0.5_p1m") + 
  geom_smooth(method=lm ,se=FALSE, fullrange=TRUE)

df_h_medfix0.5_p7m <- filter(df_h, method_snps %in% c("medfix0.5_p7m"))
p79 <- ggplot(df_h_medfix0.5_p7m, aes(x=hp, y=pmed.pure, color=tissue, shape=tissue)) +
  geom_point()+ ggtitle("medfix0.5_p7m") + 
  geom_smooth(method=lm ,se=FALSE, fullrange=TRUE)

df_h_medfixbic_p1m <- filter(df_h, method_snps %in% c("medfixbic_p1m"))
p710 <- ggplot(df_h_medfixbic_p1m, aes(x=hp, y=pmed.pure, color=tissue, shape=tissue)) +
  geom_point()+ ggtitle("medfixbic_p1m") + 
  geom_smooth(method=lm ,se=FALSE, fullrange=TRUE)


df_h_medfixbic_p7m <- filter(df_h, method_snps %in% c("medfixbic_p7m"))
p711 <- ggplot(df_h_medfixbic_p7m, aes(x=hp, y=pmed.pure, color=tissue, shape=tissue)) +
  geom_point()+ ggtitle("medfixbic_p7m") + 
  geom_smooth(method=lm ,se=FALSE, fullrange=TRUE)

ggarrange(p71, p73, p75, p77, p72, p74 ,p76, p78,
          ncol = 4, nrow = 2)

ggarrange(p78, p79, p710, p711,
          ncol = 2, nrow = 2)





##gs
#medfix0.5_p1m
df_h_gs_medfix0.5_p1m <- filter(df_h_gs, method_snps %in% c("medfix0.5_p1m"))
cor.test(df_h_gs_medfix0.5_p1m$pmed.pure, df_h_gs_medfix0.5_p1m$hp, method = "pearson")

#medfix0.5_p7m
df_h_gs_medfix0.5_p7m <- filter(df_h_gs, method_snps %in% c("medfix0.5_p7m"))
cor.test(df_h_gs_medfix0.5_p7m$pmed.pure, df_h_gs_medfix0.5_p7m$hp, method = "pearson")

#medfixbic_p1m
df_h_gs_medfixbic_p1m <- filter(df_h_gs, method_snps %in% c("medfixbic_p1m"))
cor.test(df_h_gs_medfixbic_p1m$pmed.pure, df_h_gs_medfixbic_p1m$hp, method = "pearson")

#medfixbic_p7m
df_h_gs_medfixbic_p7m <- filter(df_h_gs, method_snps %in% c("medfixbic_p7m"))
cor.test(df_h_gs_medfixbic_p7m$pmed.pure, df_h_gs_medfixbic_p7m$hp, method = "pearson")






```
