---
title: "Master Med genes"
author: "Zhikai Yang"
date: "09-17-2020"
output: NULL
---


## Normalize the path:

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE) 
knitr::opts_knit$set(root.dir=normalizePath('../../')) 
```

### read in data

```{r}
s3 <- read.csv("data/supplementary/Supplemental_Table_S3.csv")
library(data.table)
anno = fread("largedata/Zea_mays.AGPv4_anno.txt", data.table = F, header = T)
v3_v4 = fread("largedata/V3_V4.csv", data.table = F, header = F)
v3_v4 = v3_v4[,1:2]
anno = merge(v3_v4,anno, by.x = "V2", by.y = "ensembl_gene_id_v4")
s3 = merge(s3, anno, by.x = "medi", by.y = "V1", all.x = T)
colnames(s3)[10] ="medi_V4_name"
fwrite(s3, "data/supplementary/Supplemental_Table_S3.csv", row.names = F, sep = ",", quote = F)



s4 <- read.csv("data/supplementary/Supplemental_Table_S4.csv")
s4 = merge(s4, anno, by.x = "v3_id", by.y = "V1", all.x = T)
fwrite(s4, "data/supplementary/Supplemental_Table_S4.csv", row.names = F, sep = ",", quote = F)
```

```{r}
V3_V4 <- fread("./largedata/V3_V4.csv", header = FALSE , data.table=FALSE)
V3_V4 <- V3_V4[,c(1,2)]
Zea_mays.AGPv4_anno <- fread("./largedata/Zea_mays.AGPv4_anno.txt", header = TRUE, data.table = FALSE)
Zea_mays.AGPv4_anno <- data.frame(chr = Zea_mays.AGPv4_anno$chromosome_name, gene4 = Zea_mays.AGPv4_anno$ensembl_gene_id_v4, start4 = Zea_mays.AGPv4_anno$start_position, end4 = Zea_mays.AGPv4_anno$end_position, name = Zea_mays.AGPv4_anno$description)
Zea_mays.AGPv34_anno <- merge(V3_V4, Zea_mays.AGPv4_anno, by.x = "V2", by.y = "gene4")
bx10_12 = Zea_mays.AGPv34_anno[15082:15084,]
```

